<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="fc:frame" content="vNext">
  
  <!-- Result Image Meta (default to draw for now) -->
  <meta property="fc:frame:image" content="https://res.cloudinary.com/dxwhuaqga/image/upload/v1723914523/homepage_image_gx9ayx.jpg">
  <meta property="og:image" content="https://res.cloudinary.com/dxwhuaqga/image/upload/v1723914523/homepage_image_gx9ayx.jpg">
  
  <title>Rock Paper Scissors - Result</title>
</head>
<body>
  <h1>Rock Paper Scissors Result</h1>
  <div id="result">
    <img src="https://res.cloudinary.com/youraccount/image/upload/draw.png" alt="Result Image" id="result-image">
  </div>
  
  <h2>Your Current Streak: <span id="streak">0</span></h2>
  <h3>Leaderboard</h3>
  <ul id="leaderboard"></ul>

  <script>
    // Fetch move from URL query parameter
    const params = new URLSearchParams(window.location.search);
    const playerMove = params.get('move');

    // Possible moves
    const moves = ['rock', 'paper', 'scissors'];
    const computerMove = moves[Math.floor(Math.random() * 3)];

    let result = '';
    let streak = parseInt(localStorage.getItem('streak')) || 0;

    // Determine result
    if (playerMove === computerMove) {
      result = 'draw';
      document.getElementById('result-image').src = "https://res.cloudinary.com/youraccount/image/upload/draw.png";
    } else if (
      (playerMove === 'rock' && computerMove === 'scissors') ||
      (playerMove === 'paper' && computerMove === 'rock') ||
      (playerMove === 'scissors' && computerMove === 'paper')
    ) {
      result = 'win';
      streak++;
      localStorage.setItem('streak', streak);
      document.getElementById('result-image').src = "https://res.cloudinary.com/youraccount/image/upload/win.png";
    } else {
      result = 'lose';
      streak = 0;
      localStorage.setItem('streak', streak);
      document.getElementById('result-image').src = "https://res.cloudinary.com/youraccount/image/upload/lose.png";
    }

    // Display streak
    document.getElementById('streak').textContent = streak;

    // Display leaderboard (simple local leaderboard)
    const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
    leaderboard.push({ fcname: 'user1', streak: streak });
    leaderboard.sort((a, b) => b.streak - a.streak);
    localStorage.setItem('leaderboard', JSON.stringify(leaderboard));

    const leaderboardElement = document.getElementById('leaderboard');
    leaderboard.forEach(entry => {
      const li = document.createElement('li');
      li.textContent = `${entry.fcname}: ${entry.streak}`;
      leaderboardElement.appendChild(li);
    });
  </script>
</body>
</html>
